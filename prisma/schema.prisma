// Prisma schema for Stash Discord Bot
// Database: PostgreSQL (production)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Media {
  id        String   @id @default(cuid())
  mediaUrl  String   // Discord CDN or external URL
  mediaType String   // 'image', 'gif', 'video'
  tags      String[] // Native PostgreSQL array

  // Discord context
  guildId   String // Server where it was stored
  userId    String // User who stored it

  // Metadata
  fileName     String?
  thumbnailUrl String? // For GIF providers - thumbnail to show in embeds
  recallCount  Int      @default(0) // Track how many times this was recalled/sent

  createdAt DateTime  @default(now())
  deletedAt DateTime? // Soft delete timestamp

  @@index([guildId])
  @@index([userId])
  @@index([recallCount])
  @@index([deletedAt])
}
